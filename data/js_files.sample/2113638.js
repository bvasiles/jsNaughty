/*
 * jQuery timepicker addon
 * By: Trent Richardson [http://trentrichardson.com]
 * Version 1.0.5
 * Last Modified: 10/06/2012
 *
 * Copyright 2012 Trent Richardson
 * You may use this project under MIT or GPL licenses.
 * http://trentrichardson.com/Impromptu/GPL-LICENSE.txt
 * http://trentrichardson.com/Impromptu/MIT-LICENSE.txt
 *//*jslint evil: true, white: false, undef: false, nomen: false */
(function($){function Timepicker(){this.regional=[],this.regional[""]={currentText:"Now",closeText:"Done",ampm:!1,amNames:["AM","A"],pmNames:["PM","P"],timeFormat:"hh:mm tt",timeSuffix:"",timeOnlyTitle:"Choose Time",timeText:"Time",hourText:"Hour",minuteText:"Minute",secondText:"Second",millisecText:"Millisecond",timezoneText:"Time Zone",isRTL:!1},this._defaults={showButtonPanel:!0,timeOnly:!1,showHour:!0,showMinute:!0,showSecond:!1,showMillisec:!1,showTimezone:!1,showTime:!0,stepHour:1,stepMinute:1,stepSecond:1,stepMillisec:1,hour:0,minute:0,second:0,millisec:0,timezone:null,useLocalTimezone:!1,defaultTimezone:"+0000",hourMin:0,minuteMin:0,secondMin:0,millisecMin:0,hourMax:23,minuteMax:59,secondMax:59,millisecMax:999,minDateTime:null,maxDateTime:null,onSelect:null,hourGrid:0,minuteGrid:0,secondGrid:0,millisecGrid:0,alwaysSetTime:!0,separator:" ",altFieldTimeOnly:!0,altSeparator:null,altTimeSuffix:null,showTimepicker:!0,timezoneIso8601:!1,timezoneList:null,addSliderAccess:!1,sliderAccessArgs:null,controlType:"slider",defaultValue:null},$.extend(this._defaults,this.regional[""])}function isEmptyObject(a){var b;for(b in a)if(a.hasOwnProperty(a))return!1;return!0}function extendRemove(a,b){$.extend(a,b);for(var c in b)if(b[c]===null||b[c]===undefined)a[c]=b[c];return a}$.ui.timepicker=$.ui.timepicker||{};if($.ui.timepicker.version)return;$.extend($.ui,{timepicker:{version:"1.0.5"}}),$.extend(Timepicker.prototype,{$input:null,$altInput:null,$timeObj:null,inst:null,hour_slider:null,minute_slider:null,second_slider:null,millisec_slider:null,timezone_select:null,hour:0,minute:0,second:0,millisec:0,timezone:null,defaultTimezone:"+0000",hourMinOriginal:null,minuteMinOriginal:null,secondMinOriginal:null,millisecMinOriginal:null,hourMaxOriginal:null,minuteMaxOriginal:null,secondMaxOriginal:null,millisecMaxOriginal:null,ampm:"",formattedDate:"",formattedTime:"",formattedDateTime:"",timezoneList:null,units:["hour","minute","second","millisec"],control:null,setDefaults:function(a){return extendRemove(this._defaults,a||{}),this},_newInst:function($input,o){var tp_inst=new Timepicker,inlineSettings={},fns={},overrides,i;for(var attrName in this._defaults)if(this._defaults.hasOwnProperty(attrName)){var attrValue=$input.attr("time:"+attrName);if(attrValue)try{inlineSettings[attrName]=eval(attrValue)}catch(err){inlineSettings[attrName]=attrValue}}overrides={beforeShow:function(a,b){if($.isFunction(tp_inst._defaults.evnts.beforeShow))return tp_inst._defaults.evnts.beforeShow.call($input[0],a,b,tp_inst)},onChangeMonthYear:function(a,b,c){tp_inst._updateDateTime(c),$.isFunction(tp_inst._defaults.evnts.onChangeMonthYear)&&tp_inst._defaults.evnts.onChangeMonthYear.call($input[0],a,b,c,tp_inst)},onClose:function(a,b){tp_inst.timeDefined===!0&&$input.val()!==""&&tp_inst._updateDateTime(b),$.isFunction(tp_inst._defaults.evnts.onClose)&&tp_inst._defaults.evnts.onClose.call($input[0],a,b,tp_inst)}};for(i in overrides)overrides.hasOwnProperty(i)&&(fns[i]=o[i]||null);tp_inst._defaults=$.extend({},this._defaults,inlineSettings,o,overrides,{evnts:fns,timepicker:tp_inst}),tp_inst.amNames=$.map(tp_inst._defaults.amNames,function(a){return a.toUpperCase()}),tp_inst.pmNames=$.map(tp_inst._defaults.pmNames,function(a){return a.toUpperCase()}),typeof tp_inst._defaults.controlType=="string"?(tp_inst._defaults.controlType=="slider"&&$.fn.slider===undefined&&(tp_inst._defaults.controlType="select"),tp_inst.control=tp_inst._controls[tp_inst._defaults.controlType]):tp_inst.control=tp_inst._defaults.controlType;if(tp_inst._defaults.timezoneList===null){var timezoneList=["-1200","-1100","-1000","-0930","-0900","-0800","-0700","-0600","-0500","-0430","-0400","-0330","-0300","-0200","-0100","+0000","+0100","+0200","+0300","+0330","+0400","+0430","+0500","+0530","+0545","+0600","+0630","+0700","+0800","+0845","+0900","+0930","+1000","+1030","+1100","+1130","+1200","+1245","+1300","+1400"];tp_inst._defaults.timezoneIso8601&&(timezoneList=$.map(timezoneList,function(a){return a=="+0000"?"Z":a.substring(0,3)+":"+a.substring(3)})),tp_inst._defaults.timezoneList=timezoneList}tp_inst.timezone=tp_inst._defaults.timezone,tp_inst.hour=tp_inst._defaults.hour,tp_inst.minute=tp_inst._defaults.minute,tp_inst.second=tp_inst._defaults.second,tp_inst.millisec=tp_inst._defaults.millisec,tp_inst.ampm="",tp_inst.$input=$input,o.altField&&(tp_inst.$altInput=$(o.altField).css({cursor:"pointer"}).focus(function(){$input.trigger("focus")}));if(tp_inst._defaults.minDate===0||tp_inst._defaults.minDateTime===0)tp_inst._defaults.minDate=new Date;if(tp_inst._defaults.maxDate===0||tp_inst._defaults.maxDateTime===0)tp_inst._defaults.maxDate=new Date;return tp_inst._defaults.minDate!==undefined&&tp_inst._defaults.minDate instanceof Date&&(tp_inst._defaults.minDateTime=new Date(tp_inst._defaults.minDate.getTime())),tp_inst._defaults.minDateTime!==undefined&&tp_inst._defaults.minDateTime instanceof Date&&(tp_inst._defaults.minDate=new Date(tp_inst._defaults.minDateTime.getTime())),tp_inst._defaults.maxDate!==undefined&&tp_inst._defaults.maxDate instanceof Date&&(tp_inst._defaults.maxDateTime=new Date(tp_inst._defaults.maxDate.getTime())),tp_inst._defaults.maxDateTime!==undefined&&tp_inst._defaults.maxDateTime instanceof Date&&(tp_inst._defaults.maxDate=new Date(tp_inst._defaults.maxDateTime.getTime())),tp_inst.$input.bind("focus",function(){tp_inst._onFocus()}),tp_inst},_addTimePicker:function(a){var b=this.$altInput&&this._defaults.altFieldTimeOnly?this.$input.val()+" "+this.$altInput.val():this.$input.val();this.timeDefined=this._parseTime(b),this._limitMinMaxDateTime(a,!1),this._injectTimePicker()},_parseTime:function(a,b){this.inst||(this.inst=$.datepicker._getInst(this.$input[0]));if(b||!this._defaults.timeOnly){var c=$.datepicker._get(this.inst,"dateFormat");try{var d=parseDateTimeInternal(c,this._defaults.timeFormat,a,$.datepicker._getFormatConfig(this.inst),this._defaults);if(!d.timeObj)return!1;$.extend(this,d.timeObj)}catch(e){return!1}return!0}var f=$.datepicker.parseTime(this._defaults.timeFormat,a,this._defaults);return f?($.extend(this,f),!0):!1},_injectTimePicker:function(){var a=this.inst.dpDiv,b=this.inst.settings,c=this,d="",e="",f={},g={},h=null;if(a.find("div.ui-timepicker-div").length===0&&b.showTimepicker){var i=' style="display:none;"',j='<div class="ui-timepicker-div'+(b.isRTL?" ui-timepicker-rtl":"")+'"><dl>'+'<dt class="ui_tpicker_time_label"'+(b.showTime?"":i)+">"+b.timeText+"</dt>"+'<dd class="ui_tpicker_time"'+(b.showTime?"":i)+"></dd>";for(var k=0,l=this.units.length;k<l;k++){d=this.units[k],e=d.substr(0,1).toUpperCase()+d.substr(1),f[d]=parseInt(b[d+"Max"]-(b[d+"Max"]-b[d+"Min"])%b["step"+e],10),g[d]=0,j+='<dt class="ui_tpicker_'+d+'_label"'+(b["show"+e]?"":i)+">"+b[d+"Text"]+"</dt>"+'<dd class="ui_tpicker_'+d+'"><div class="ui_tpicker_'+d+'_slider"'+(b["show"+e]?"":i)+"></div>";if(b["show"+e]&&b[d+"Grid"]>0){j+='<div style="padding-left: 1px"><table class="ui-tpicker-grid-label"><tr>';if(d=="hour")for(var m=b[d+"Min"];m<=f[d];m+=parseInt(b[d+"Grid"],10)){g[d]++;var n=b.ampm&&m>12?m-12:m;n<10&&(n="0"+n),b.ampm&&(m===0?n="12a":m<12?n+="a":n+="p"),j+='<td data-for="'+d+'">'+n+"</td>"}else for(var o=b[d+"Min"];o<=f[d];o+=parseInt(b[d+"Grid"],10))g[d]++,j+='<td data-for="'+d+'">'+(o<10?"0":"")+o+"</td>";j+="</tr></table></div>"}j+="</dd>"}j+='<dt class="ui_tpicker_timezone_label"'+(b.showTimezone?"":i)+">"+b.timezoneText+"</dt>",j+='<dd class="ui_tpicker_timezone" '+(b.showTimezone?"":i)+"></dd>",j+="</dl></div>";var p=$(j);b.timeOnly===!0&&(p.prepend('<div class="ui-widget-header ui-helper-clearfix ui-corner-all"><div class="ui-datepicker-title">'+b.timeOnlyTitle+"</div>"+"</div>"),a.find(".ui-datepicker-header, .ui-datepicker-calendar").hide());for(var k=0,l=c.units.length;k<l;k++)d=c.units[k],e=d.substr(0,1).toUpperCase()+d.substr(1),c[d+"_slider"]=c.control.create(c,p.find(".ui_tpicker_"+d+"_slider"),d,c[d],b[d+"Min"],f[d],b["step"+e]),b["show"+e]&&b[d+"Grid"]>0&&(h=100*g[d]*b[d+"Grid"]/(f[d]-b[d+"Min"]),p.find(".ui_tpicker_"+d+" table").css({width:h+"%",marginLeft:b.isRTL?"0":h/(-2*g[d])+"%",marginRight:b.isRTL?h/(-2*g[d])+"%":"0",borderCollapse:"collapse"}).find("td").click(function(a){var d=$(this),e=d.html(),f=d.data("for");if(f=="hour"&&b.ampm){var g=e.substring(2).toLowerCase(),h=parseInt(e.substring(0,2),10);g=="a"?h==12?e=0:e=h:h==12?e=12:e=h+12}c.control.value(c,c[f+"_slider"],parseInt(e,10)),c._onTimeChange(),c._onSelectHandler()}).css({cursor:"pointer",width:100/g[d]+"%",textAlign:"center",overflow:"hidden"}));this.timezone_select=p.find(".ui_tpicker_timezone").append("<select></select>").find("select"),$.fn.append.apply(this.timezone_select,$.map(b.timezoneList,function(a,b){return $("<option />").val(typeof a=="object"?a.value:a).text(typeof a=="object"?a.label:a)}));if(typeof this.timezone!="undefined"&&this.timezone!==null&&this.timezone!==""){var q=new Date(this.inst.selectedYear,this.inst.selectedMonth,this.inst.selectedDay,12),r=$.timepicker.timeZoneOffsetString(q);r==this.timezone?selectLocalTimeZone(c):this.timezone_select.val(this.timezone)}else typeof this.hour!="undefined"&&this.hour!==null&&this.hour!==""?this.timezone_select.val(b.defaultTimezone):selectLocalTimeZone(c);this.timezone_select.change(function(){c._defaults.useLocalTimezone=!1,c._onTimeChange()});var s=a.find(".ui-datepicker-buttonpane");s.length?s.before(p):a.append(p),this.$timeObj=p.find(".ui_tpicker_time");if(this.inst!==null){var t=this.timeDefined;this._onTimeChange(),this.timeDefined=t}if(this._defaults.addSliderAccess){var u=this._defaults.sliderAccessArgs,v=this._defaults.isRTL;u.isRTL=v,setTimeout(function(){if(p.find(".ui-slider-access").length===0){p.find(".ui-slider:visible").sliderAccess(u);var a=p.find(".ui-slider-access:eq(0)").outerWidth(!0);a&&p.find("table:visible").each(function(){var b=$(this),c=b.outerWidth(),d=b.css(v?"marginRight":"marginLeft").toString().replace("%",""),e=c-a,f=d*e/c+"%",g={width:e,marginRight:0,marginLeft:0};g[v?"marginRight":"marginLeft"]=f,b.css(g)})}},10)}}},_limitMinMaxDateTime:function(a,b){var c=this._defaults,d=new Date(a.selectedYear,a.selectedMonth,a.selectedDay);if(!this._defaults.showTimepicker)return;if($.datepicker._get(a,"minDateTime")!==null&&$.datepicker._get(a,"minDateTime")!==undefined&&d){var e=$.datepicker._get(a,"minDateTime"),f=new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,0,0,0);if(this.hourMinOriginal===null||this.minuteMinOriginal===null||this.secondMinOriginal===null||this.millisecMinOriginal===null)this.hourMinOriginal=c.hourMin,this.minuteMinOriginal=c.minuteMin,this.secondMinOriginal=c.secondMin,this.millisecMinOriginal=c.millisecMin;a.settings.timeOnly||f.getTime()==d.getTime()?(this._defaults.hourMin=e.getHours(),this.hour<=this._defaults.hourMin?(this.hour=this._defaults.hourMin,this._defaults.minuteMin=e.getMinutes(),this.minute<=this._defaults.minuteMin?(this.minute=this._defaults.minuteMin,this._defaults.secondMin=e.getSeconds(),this.second<=this._defaults.secondMin?(this.second=this._defaults.secondMin,this._defaults.millisecMin=e.getMilliseconds()):(this.millisec<this._defaults.millisecMin&&(this.millisec=this._defaults.millisecMin),this._defaults.millisecMin=this.millisecMinOriginal)):(this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal)):(this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal)):(this._defaults.hourMin=this.hourMinOriginal,this._defaults.minuteMin=this.minuteMinOriginal,this._defaults.secondMin=this.secondMinOriginal,this._defaults.millisecMin=this.millisecMinOriginal)}if($.datepicker._get(a,"maxDateTime")!==null&&$.datepicker._get(a,"maxDateTime")!==undefined&&d){var g=$.datepicker._get(a,"maxDateTime"),h=new Date(g.getFullYear(),g.getMonth(),g.getDate(),0,0,0,0);if(this.hourMaxOriginal===null||this.minuteMaxOriginal===null||this.secondMaxOriginal===null)this.hourMaxOriginal=c.hourMax,this.minuteMaxOriginal=c.minuteMax,this.secondMaxOriginal=c.secondMax,this.millisecMaxOriginal=c.millisecMax;a.settings.timeOnly||h.getTime()==d.getTime()?(this._defaults.hourMax=g.getHours(),this.hour>=this._defaults.hourMax?(this.hour=this._defaults.hourMax,this._defaults.minuteMax=g.getMinutes(),this.minute>=this._defaults.minuteMax?(this.minute=this._defaults.minuteMax,this._defaults.secondMax=g.getSeconds()):this.second>=this._defaults.secondMax?(this.second=this._defaults.secondMax,this._defaults.millisecMax=g.getMilliseconds()):(this.millisec>this._defaults.millisecMax&&(this.millisec=this._defaults.millisecMax),this._defaults.millisecMax=this.millisecMaxOriginal)):(this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal)):(this._defaults.hourMax=this.hourMaxOriginal,this._defaults.minuteMax=this.minuteMaxOriginal,this._defaults.secondMax=this.secondMaxOriginal,this._defaults.millisecMax=this.millisecMaxOriginal)}if(b!==undefined&&b===!0){var i=parseInt(this._defaults.hourMax-(this._defaults.hourMax-this._defaults.hourMin)%this._defaults.stepHour,10),j=parseInt(this._defaults.minuteMax-(this._defaults.minuteMax-this._defaults.minuteMin)%this._defaults.stepMinute,10),k=parseInt(this._defaults.secondMax-(this._defaults.secondMax-this._defaults.secondMin)%this._defaults.stepSecond,10),l=parseInt(this._defaults.millisecMax-(this._defaults.millisecMax-this._defaults.millisecMin)%this._defaults.stepMillisec,10);this.hour_slider&&(this.control.options(this,this.hour_slider,{min:this._defaults.hourMin,max:i}),this.control.value(this,this.hour_slider,this.hour)),this.minute_slider&&(this.control.options(this,this.minute_slider,{min:this._defaults.minuteMin,max:j}),this.control.value(this,this.minute_slider,this.minute)),this.second_slider&&(this.control.options(this,this.second_slider,{min:this._defaults.secondMin,max:k}),this.control.value(this,this.second_slider,this.second)),this.millisec_slider&&(this.control.options(this,this.millisec_slider,{min:this._defaults.millisecMin,max:l}),this.control.value(this,this.millisec_slider,this.millisec))}},_onTimeChange:function(){var a=this.hour_slider?this.control.value(this,this.hour_slider):!1,b=this.minute_slider?this.control.value(this,this.minute_slider):!1,c=this.second_slider?this.control.value(this,this.second_slider):!1,d=this.millisec_slider?this.control.value(this,this.millisec_slider):!1,e=this.timezone_select?this.timezone_select.val():!1,f=this._defaults;typeof a=="object"&&(a=!1),typeof b=="object"&&(b=!1),typeof c=="object"&&(c=!1),typeof d=="object"&&(d=!1),typeof e=="object"&&(e=!1),a!==!1&&(a=parseInt(a,10)),b!==!1&&(b=parseInt(b,10)),c!==!1&&(c=parseInt(c,10)),d!==!1&&(d=parseInt(d,10));var g=f[a<12?"amNames":"pmNames"][0],h=a!=this.hour||b!=this.minute||c!=this.second||d!=this.millisec||this.ampm.length>0&&a<12!=($.inArray(this.ampm.toUpperCase(),this.amNames)!==-1)||this.timezone===null&&e!=this.defaultTimezone||this.timezone!==null&&e!=this.timezone;h&&(a!==!1&&(this.hour=a),b!==!1&&(this.minute=b),c!==!1&&(this.second=c),d!==!1&&(this.millisec=d),e!==!1&&(this.timezone=e),this.inst||(this.inst=$.datepicker._getInst(this.$input[0])),this._limitMinMaxDateTime(this.inst,!0)),f.ampm&&(this.ampm=g),this.formattedTime=$.datepicker.formatTime(this._defaults.timeFormat,this,this._defaults),this.$timeObj&&this.$timeObj.text(this.formattedTime+f.timeSuffix),this.timeDefined=!0,h&&this._updateDateTime()},_onSelectHandler:function(){var a=this._defaults.onSelect||this.inst.settings.onSelect,b=this.$input?this.$input[0]:null;a&&b&&a.apply(b,[this.formattedDateTime,this])},_updateDateTime:function(a){a=this.inst||a;var b=$.datepicker._daylightSavingAdjust(new Date(a.selectedYear,a.selectedMonth,a.selectedDay)),c=$.datepicker._get(a,"dateFormat"),d=$.datepicker._getFormatConfig(a),e=b!==null&&this.timeDefined;this.formattedDate=$.datepicker.formatDate(c,b===null?new Date:b,d);var f=this.formattedDate;this._defaults.timeOnly===!0?f=this.formattedTime:this._defaults.timeOnly!==!0&&(this._defaults.alwaysSetTime||e)&&(f+=this._defaults.separator+this.formattedTime+this._defaults.timeSuffix),this.formattedDateTime=f;if(!this._defaults.showTimepicker)this.$input.val(this.formattedDate);else if(this.$altInput&&this._defaults.altFieldTimeOnly===!0)this.$altInput.val(this.formattedTime),this.$input.val(this.formattedDate);else if(this.$altInput){this.$input.val(f);var g="",h=this._defaults.altSeparator?this._defaults.altSeparator:this._defaults.separator,i=this._defaults.altTimeSuffix?this._defaults.altTimeSuffix:this._defaults.timeSuffix;this._defaults.altFormat?g=$.datepicker.formatDate(this._defaults.altFormat,b===null?new Date:b,d):g=this.formattedDate,g&&(g+=h),this._defaults.altTimeFormat?g+=$.datepicker.formatTime(this._defaults.altTimeFormat,this,this._defaults)+i:g+=this.formattedTime+i,this.$altInput.val(g)}else this.$input.val(f);this.$input.trigger("change")},_onFocus:function(){if(!this.$input.val()&&this._defaults.defaultValue){this.$input.val(this._defaults.defaultValue);var a=$.datepicker._getInst(this.$input.get(0)),b=$.datepicker._get(a,"timepicker");if(b&&b._defaults.timeOnly&&a.input.val()!=a.lastVal)try{$.datepicker._updateDatepicker(a)}catch(c){$.datepicker.log(c)}}},_controls:{slider:{create:function(a,b,c,d,e,f,g){var h=a._defaults.isRTL;return b.prop("slide",null).slider({orientation:"horizontal",value:h?d*-1:d,min:h?f*-1:e,max:h?e*-1:f,step:g,slide:function(b,c){a.control.value(a,$(this),h?c.value*-1:c.value),a._onTimeChange()},stop:function(b,c){a._onSelectHandler()}})},options:function(a,b,c,d){if(a._defaults.isRTL){if(typeof c=="string")return c=="min"||c=="max"?d!==undefined?b.slider(c,d*-1):Math.abs(b.slider(c)):b.slider(c);var e=c.min,f=c.max;return c.min=c.max=null,e!==undefined&&(c.max=e*-1),f!==undefined&&(c.min=f*-1),b.slider(c)}return typeof c=="string"&&d!==undefined?b.slider(c,d):b.slider(c)},value:function(a,b,c){return a._defaults.isRTL?c!==undefined?b.slider("value",c*-1):Math.abs(b.slider("value")):c!==undefined?b.slider("value",c):b.slider("value")}},select:{create:function(a,b,c,d,e,f,g){var h='<select class="ui-timepicker-select" data-unit="'+c+'" data-min="'+e+'" data-max="'+f+'" data-step="'+g+'">',i=a._defaults.timeFormat.indexOf("t")!==-1?"toLowerCase":"toUpperCase",j=0;for(var k=e;k<=f;k+=g)h+='<option value="'+k+'"'+(k==d?" selected":"")+">",c=="hour"&&a._defaults.ampm?(j=k%12,k===0||k===12?h+="12":j<10?h+="0"+j.toString():h+=j,h+=" "+(k<12?a._defaults.amNames[0]:a._defaults.pmNames[0])[i]()):c=="millisec"||k>=10?h+=k:h+="0"+k.toString(),h+="</option>";return h+="</select>",b.children("select").remove(),$(h).appendTo(b).change(function(b){a._onTimeChange(),a._onSelectHandler()}),b},options:function(a,b,c,d){var e={},f=b.children("select");if(typeof c=="string"){if(d===undefined)return f.data(c);e[c]=d}else e=c;return a.control.create(a,b,f.data("unit"),f.val(),e.min||f.data("min"),e.max||f.data("max"),e.step||f.data("step"))},value:function(a,b,c){var d=b.children("select");return c!==undefined?d.val(c):d.val()}}}}),$.fn.extend({timepicker:function(a){a=a||{};var b=Array.prototype.slice.call(arguments);return typeof a=="object"&&(b[0]=$.extend(a,{timeOnly:!0})),$(this).each(function(){$.fn.datetimepicker.apply($(this),b)})},datetimepicker:function(a){a=a||{};var b=arguments;return typeof a=="string"?a=="getDate"?$.fn.datepicker.apply($(this[0]),b):this.each(function(){var a=$(this);a.datepicker.apply(a,b)}):this.each(function(){var b=$(this);b.datepicker($.timepicker._newInst(b,a)._defaults)})}}),$.datepicker.parseDateTime=function(a,b,c,d,e){var f=parseDateTimeInternal(a,b,c,d,e);if(f.timeObj){var g=f.timeObj;f.date.setHours(g.hour,g.minute,g.second,g.millisec)}return f.date},$.datepicker.parseTime=function(a,b,c){var d=function(a,b){var c=[];return a&&$.merge(c,a),b&&$.merge(c,b),c=$.map(c,function(a){return a.replace(/[.*+?|()\[\]{}\\]/g,"\\$&")}),"("+c.join("|")+")?"},e=function(a){var b=a.toLowerCase().match(/(h{1,2}|m{1,2}|s{1,2}|l{1}|t{1,2}|z|'.*?')/g),c={h:-1,m:-1,s:-1,l:-1,t:-1,z:-1};if(b)for(var d=0;d<b.length;d++)c[b[d].toString().charAt(0)]==-1&&(c[b[d].toString().charAt(0)]=d+1);return c},f=extendRemove(extendRemove({},$.timepicker._defaults),c||{}),g="^"+a.toString().replace(/(hh?|mm?|ss?|[tT]{1,2}|[lz]|'.*?')/g,function(a){switch(a.charAt(0).toLowerCase()){case"h":return"(\\d?\\d)";case"m":return"(\\d?\\d)";case"s":return"(\\d?\\d)";case"l":return"(\\d?\\d?\\d)";case"z":return"(z|[-+]\\d\\d:?\\d\\d|\\S+)?";case"t":return d(f.amNames,f.pmNames);default:return"("+a.replace(/\'/g,"").replace(/(\.|\$|\^|\\|\/|\(|\)|\[|\]|\?|\+|\*)/g,function(a){return"\\"+a})+")?"}}).replace(/\s/g,"\\s?")+f.timeSuffix+"$",h=e(a),i="",j;j=b.match(new RegExp(g,"i"));var k={hour:0,minute:0,second:0,millisec:0};if(j){h.t!==-1&&(j[h.t]===undefined||j[h.t].length===0?(i="",k.ampm=""):(i=$.inArray(j[h.t].toUpperCase(),f.amNames)!==-1?"AM":"PM",k.ampm=f[i=="AM"?"amNames":"pmNames"][0])),h.h!==-1&&(i=="AM"&&j[h.h]=="12"?k.hour=0:i=="PM"&&j[h.h]!="12"?k.hour=parseInt(j[h.h],10)+12:k.hour=Number(j[h.h])),h.m!==-1&&(k.minute=Number(j[h.m])),h.s!==-1&&(k.second=Number(j[h.s])),h.l!==-1&&(k.millisec=Number(j[h.l]));if(h.z!==-1&&j[h.z]!==undefined){var l=j[h.z].toUpperCase();switch(l.length){case 1:l=f.timezoneIso8601?"Z":"+0000";break;case 5:f.timezoneIso8601&&(l=l.substring(1)=="0000"?"Z":l.substring(0,3)+":"+l.substring(3));break;case 6:f.timezoneIso8601?l.substring(1)=="00:00"&&(l="Z"):l=l=="Z"||l.substring(1)=="00:00"?"+0000":l.replace(/:/,"")}k.timezone=l}return k}return!1},$.datepicker.formatTime=function(a,b,c){c=c||{},c=$.extend({},$.timepicker._defaults,c),b=$.extend({hour:0,minute:0,second:0,millisec:0,timezone:"+0000"},b);var d=a,e=c.amNames[0],f=parseInt(b.hour,10);return c.ampm&&(f>11&&(e=c.pmNames[0],f>12&&(f%=12)),f===0&&(f=12)),d=d.replace(/(?:hh?|mm?|ss?|[tT]{1,2}|[lz]|'.*?')/g,function(a){switch(a.toLowerCase()){case"hh":return("0"+f).slice(-2);case"h":return f;case"mm":return("0"+b.minute).slice(-2);case"m":return b.minute;case"ss":return("0"+b.second).slice(-2);case"s":return b.second;case"l":return("00"+b.millisec).slice(-3);case"z":return b.timezone===null?c.defaultTimezone:b.timezone;case"t":case"tt":if(c.ampm)return a.length==1&&(e=e.charAt(0)),a.charAt(0)==="T"?e.toUpperCase():e.toLowerCase();return"";default:return a.replace(/\'/g,"")||"'"}}),d=$.trim(d),d},$.datepicker._base_selectDate=$.datepicker._selectDate,$.datepicker._selectDate=function(a,b){var c=this._getInst($(a)[0]),d=this._get(c,"timepicker");d?(d._limitMinMaxDateTime(c,!0),c.inline=c.stay_open=!0,this._base_selectDate(a,b),c.inline=c.stay_open=!1,this._notifyChange(c),this._updateDatepicker(c)):this._base_selectDate(a,b)},$.datepicker._base_updateDatepicker=$.datepicker._updateDatepicker,$.datepicker._updateDatepicker=function(a){var b=a.input[0];if($.datepicker._curInst&&$.datepicker._curInst!=a&&$.datepicker._datepickerShowing&&$.datepicker._lastInput!=b)return;if(typeof a.stay_open!="boolean"||a.stay_open===!1){this._base_updateDatepicker(a);var c=this._get(a,"timepicker");if(c){c._addTimePicker(a);if(c._defaults.useLocalTimezone){var d=new Date(a.selectedYear,a.selectedMonth,a.selectedDay,12);selectLocalTimeZone(c,d),c._onTimeChange()}}}},$.datepicker._base_doKeyPress=$.datepicker._doKeyPress,$.datepicker._doKeyPress=function(a){var b=$.datepicker._getInst(a.target),c=$.datepicker._get(b,"timepicker");if(c&&$.datepicker._get(b,"constrainInput")){var d=c._defaults.ampm,e=$.datepicker._possibleChars($.datepicker._get(b,"dateFormat")),f=c._defaults.timeFormat.toString().replace(/[hms]/g,"").replace(/TT/g,d?"APM":"").replace(/Tt/g,d?"AaPpMm":"").replace(/tT/g,d?"AaPpMm":"").replace(/T/g,d?"AP":"").replace(/tt/g,d?"apm":"").replace(/t/g,d?"ap":"")+" "+c._defaults.separator+c._defaults.timeSuffix+(c._defaults.showTimezone?c._defaults.timezoneList.join(""):"")+c._defaults.amNames.join("")+c._defaults.pmNames.join("")+e,g=String.fromCharCode(a.charCode===undefined?a.keyCode:a.charCode);return a.ctrlKey||g<" "||!e||f.indexOf(g)>-1}return $.datepicker._base_doKeyPress(a)},$.datepicker._base_updateAlternate=$.datepicker._updateAlternate,$.datepicker._updateAlternate=function(a){var b=this._get(a,"timepicker");if(b){var c=b._defaults.altField;if(c){var d=b._defaults.altFormat||b._defaults.dateFormat,e=this._getDate(a),f=$.datepicker._getFormatConfig(a),g="",h=b._defaults.altSeparator?b._defaults.altSeparator:b._defaults.separator,i=b._defaults.altTimeSuffix?b._defaults.altTimeSuffix:b._defaults.timeSuffix,j=b._defaults.altTimeFormat!==undefined?b._defaults.altTimeFormat:b._defaults.timeFormat;g+=$.datepicker.formatTime(j,b,b._defaults)+i,!b._defaults.timeOnly&&!b._defaults.altFieldTimeOnly&&(b._defaults.altFormat?g=$.datepicker.formatDate(b._defaults.altFormat,e===null?new Date:e,f)+h+g:g=b.formattedDate+h+g),$(c).val(g)}}else $.datepicker._base_updateAlternate(a)},$.datepicker._base_doKeyUp=$.datepicker._doKeyUp,$.datepicker._doKeyUp=function(a){var b=$.datepicker._getInst(a.target),c=$.datepicker._get(b,"timepicker");if(c&&c._defaults.timeOnly&&b.input.val()!=b.lastVal)try{$.datepicker._updateDatepicker(b)}catch(d){$.datepicker.log(d)}return $.datepicker._base_doKeyUp(a)},$.datepicker._base_gotoToday=$.datepicker._gotoToday,$.datepicker._gotoToday=function(a){var b=this._getInst($(a)[0]),c=b.dpDiv;this._base_gotoToday(a);var d=this._get(b,"timepicker");selectLocalTimeZone(d);var e=new Date;this._setTime(b,e),$(".ui-datepicker-today",c).click()},$.datepicker._disableTimepickerDatepicker=function(a){var b=this._getInst(a);if(!b)return;var c=this._get(b,"timepicker");$(a).datepicker("getDate"),c&&(c._defaults.showTimepicker=!1,c._updateDateTime(b))},$.datepicker._enableTimepickerDatepicker=function(a){var b=this._getInst(a);if(!b)return;var c=this._get(b,"timepicker");$(a).datepicker("getDate"),c&&(c._defaults.showTimepicker=!0,c._addTimePicker(b),c._updateDateTime(b))},$.datepicker._setTime=function(a,b){var c=this._get(a,"timepicker");if(c){var d=c._defaults;c.hour=b?b.getHours():d.hour,c.minute=b?b.getMinutes():d.minute,c.second=b?b.getSeconds():d.second,c.millisec=b?b.getMilliseconds():d.millisec,c._limitMinMaxDateTime(a,!0),c._onTimeChange(),c._updateDateTime(a)}},$.datepicker._setTimeDatepicker=function(a,b,c){var d=this._getInst(a);if(!d)return;var e=this._get(d,"timepicker");if(e){this._setDateFromField(d);var f;b&&(typeof b=="string"?(e._parseTime(b,c),f=new Date,f.setHours(e.hour,e.minute,e.second,e.millisec)):f=new Date(b.getTime()),f.toString()=="Invalid Date"&&(f=undefined),this._setTime(d,f))}},$.datepicker._base_setDateDatepicker=$.datepicker._setDateDatepicker,$.datepicker._setDateDatepicker=function(a,b){var c=this._getInst(a);if(!c)return;var d=b instanceof Date?new Date(b.getTime()):b;this._updateDatepicker(c),this._base_setDateDatepicker.apply(this,arguments),this._setTimeDatepicker(a,d,!0)},$.datepicker._base_getDateDatepicker=$.datepicker._getDateDatepicker,$.datepicker._getDateDatepicker=function(a,b){var c=this._getInst(a);if(!c)return;var d=this._get(c,"timepicker");if(d){c.lastVal===undefined&&this._setDateFromField(c,b);var e=this._getDate(c);return e&&d._parseTime($(a).val(),d.timeOnly)&&e.setHours(d.hour,d.minute,d.second,d.millisec),e}return this._base_getDateDatepicker(a,b)},$.datepicker._base_parseDate=$.datepicker.parseDate,$.datepicker.parseDate=function(a,b,c){var d;try{d=this._base_parseDate(a,b,c)}catch(e){d=this._base_parseDate(a,b.substring(0,b.length-(e.length-e.indexOf(":")-2)),c)}return d},$.datepicker._base_formatDate=$.datepicker._formatDate,$.datepicker._formatDate=function(a,b,c,d){var e=this._get(a,"timepicker");return e?(e._updateDateTime(a),e.$input.val()):this._base_formatDate(a)},$.datepicker._base_optionDatepicker=$.datepicker._optionDatepicker,$.datepicker._optionDatepicker=function(a,b,c){var d=this._getInst(a),e;if(!d)return null;var f=this._get(d,"timepicker");if(f){var g=null,h=null,i=null,j=f._defaults.evnts,k={},l;if(typeof b=="string"){if(b==="minDate"||b==="minDateTime")g=c;else if(b==="maxDate"||b==="maxDateTime")h=c;else if(b==="onSelect")i=c;else if(j.hasOwnProperty(b)){if(typeof c=="undefined")return j[b];k[b]=c,e={}}}else if(typeof b=="object"){b.minDate?g=b.minDate:b.minDateTime?g=b.minDateTime:b.maxDate?h=b.maxDate:b.maxDateTime&&(h=b.maxDateTime);for(l in j)j.hasOwnProperty(l)&&b[l]&&(k[l]=b[l])}for(l in k)k.hasOwnProperty(l)&&(j[l]=k[l],e||(e=$.extend({},b)),delete e[l]);if(e&&isEmptyObject(e))return;g?(g===0?g=new Date:g=new Date(g),f._defaults.minDate=g,f._defaults.minDateTime=g):h?(h===0?h=new Date:h=new Date(h),f._defaults.maxDate=h,f._defaults.maxDateTime=h):i&&(f._defaults.onSelect=i)}return c===undefined?this._base_optionDatepicker.call($.datepicker,a,b):this._base_optionDatepicker.call($.datepicker,a,e||b,c)};var splitDateTime=function(a,b,c,d){try{var e=d&&d.separator?d.separator:$.timepicker._defaults.separator,f=d&&d.timeFormat?d.timeFormat:$.timepicker._defaults.timeFormat,g=d&&d.ampm?d.ampm:$.timepicker._defaults.ampm,h=f.split(e),i=h.length,j=b.split(e),k=j.length;g||(h=$.trim(f.replace(/t/gi,"")).split(e),i=h.length);if(k>1)return[j.splice(0,k-i).join(e),j.splice(0,i).join(e)]}catch(l){if(l.indexOf(":")>=0){var m=b.length-(l.length-l.indexOf(":")-2),n=b.substring(m);return[$.trim(b.substring(0,m)),$.trim(b.substring(m))]}throw l}return[b,""]},parseDateTimeInternal=function(a,b,c,d,e){var f,g=splitDateTime(a,c,d,e);f=$.datepicker._base_parseDate(a,g[0],d);if(g[1]!==""){var h=g[1],i=$.datepicker.parseTime(b,h,e);if(i===null)throw"Wrong time format";return{date:f,timeObj:i}}return{date:f}},selectLocalTimeZone=function(a,b){if(a&&a.timezone_select){a._defaults.useLocalTimezone=!0;var c=typeof b!="undefined"?b:new Date,d=$.timepicker.timeZoneOffsetString(c);a._defaults.timezoneIso8601&&(d=d.substring(0,3)+":"+d.substring(3)),a.timezone_select.val(d)}};$.timepicker=new Timepicker,$.timepicker.timeZoneOffsetString=function(a){var b=a.getTimezoneOffset()*-1,c=b%60,d=(b-c)/60;return(b>=0?"+":"-")+("0"+(d*101).toString()).substr(-2)+("0"+(c*101).toString()).substr(-2)},$.timepicker.timeRange=function(a,b,c){return $.timepicker.handleRange("timepicker",a,b,c)},$.timepicker.dateTimeRange=function(a,b,c){$.timepicker.dateRange(a,b,c,"datetimepicker")},$.timepicker.dateRange=function(a,b,c,d){d=d||"datepicker",$.timepicker.handleRange(d,a,b,c)},$.timepicker.handleRange=function(a,b,c,d){function e(a,d,e){d.val()&&new Date(b.val())>new Date(c.val())&&d.val(e)}function f(b,c,d){if(!$(b).val())return;var e=$(b)[a].call($(b),"getDate");e.getTime&&$(c)[a].call($(c),"option",d,e)}return $.fn[a].call(b,$.extend({onClose:function(a,b){e(this,c,a)},onSelect:function(a){f(this,c,"minDate")}},d,d.start)),$.fn[a].call(c,$.extend({onClose:function(a,c){e(this,b,a)},onSelect:function(a){f(this,b,"maxDate")}},d,d.end)),a!="timepicker"&&d.reformat&&$([b,c]).each(function(){var b=$(this)[a].call($(this),"option","dateFormat"),c=new Date($(this).val());$(this).val()&&c&&$(this).val($.datepicker.formatDate(b,c))}),e(b,c,b.val()),f(b,c,"minDate"),f(c,b,"maxDate"),$([b.get(0),c.get(0)])},$.timepicker.version="1.0.5"})(jQuery);